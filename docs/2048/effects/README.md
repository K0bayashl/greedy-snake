# 视觉特效系统

## 功能概述

为2048游戏添加了一套完整的视觉特效系统，包括三套主题切换、粒子爆炸效果、震动反馈和设置面板，大幅提升游戏的视觉体验和交互反馈。

## 功能特性

### 1. 三套主题切换

| 主题 | 描述 | 特点 |
|------|------|------|
| 原色主题 | 经典2048配色 | 暖色调，米色背景，经典方块颜色 |
| 暗黑主题 | 深色护眼模式 | 深色背景，高对比度，适合夜间使用 |
| 霓虹主题 | 赛博朋克风格 | 荧光色彩，发光效果，视觉冲击力强 |

- 支持点击主题按钮快速切换
- 主题选择自动保存到 localStorage
- 切换时带有平滑过渡动画

### 2. 粒子爆炸效果

当方块合并时触发粒子爆炸动画：

- **触发时机**：两个相同数字方块合并时
- **粒子类型**：圆形粒子，颜色与合并后的方块一致
- **动画效果**：粒子向四周扩散，带有重力下落效果
- **密度调节**：支持三档密度（低/中/高）

### 3. 震动反馈

在关键操作节点提供震动反馈：

| 触发场景 | 反馈强度 | 说明 |
|----------|----------|------|
| 方块移动 | 轻微 | 每次有效移动时 |
| 方块合并 | 中等 | 合并时触发 |
| 游戏胜利 | 强烈 | 合成2048时 |
| 游戏失败 | 强烈 | 无法移动时 |

- 支持移动端震动 API (Vibration API)
- 桌面端使用 CSS 动画模拟震动效果
- 可在设置中开启/关闭

### 4. 设置面板

点击设置按钮打开设置面板：

- **粒子密度**：低 / 中 / 高三档选择
- **粒子开关**：开启/关闭粒子效果
- **震动开关**：开启/关闭震动反馈
- **设置持久化**：自动保存到 localStorage

## 使用方法

### 主题切换

1. 点击游戏界面上的主题按钮（原色/暗黑/霓虹）
2. 界面立即切换到对应主题
3. 主题偏好自动保存

### 调整特效设置

1. 点击设置按钮打开设置面板
2. 调整粒子密度滑块
3. 勾选/取消勾选特效开关
4. 点击关闭或面板外区域关闭设置面板

### 体验特效

- 正常游戏，移动方块时感受震动反馈
- 合并方块时观察粒子爆炸效果
- 合成2048时体验胜利特效

## 技术要点

### 性能优化

- 粒子使用对象池管理，避免频繁创建销毁
- 使用 CSS 变量实现主题切换，无需重绘大量元素
- 震动效果使用 CSS transform，利用 GPU 加速
- 粒子数量根据密度设置动态调整

### 浏览器兼容

- 主题切换：所有现代浏览器支持
- 粒子效果：使用 Canvas API，IE9+ 支持
- 震动 API：移动端支持较好，桌面端自动降级到 CSS 动画

## 文件变更

| 文件 | 变更内容 |
|------|----------|
| `src/2048/index.html` | 添加主题按钮、设置按钮、设置面板、粒子容器 |
| `src/2048/style.css` | 添加三套主题CSS变量、粒子样式、震动动画、设置面板样式 |
| `src/2048/game.js` | 添加 ThemeManager、ParticleSystem、EffectsManager、SettingsManager 四个类 |

## 配置存储

使用 localStorage 存储用户偏好：

```javascript
// 存储键名
'2048-theme'        // 当前主题
'2048-settings'     // 特效设置
```

## 注意事项

1. 粒子效果在性能较低的设备上可能影响帧率，建议调低粒子密度
2. 震动反馈在 iOS Safari 上需要用户交互后才能触发
3. 主题切换时方块颜色会平滑过渡，但已存在的方块数字颜色保持不变
